<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3D Character Poser</title>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>üé≠ 3D Character Poser</h1>
        <p>Pose 3D characters using bone controls</p>
      </header>
      
      <div class="toolbar">
        <button id="reset-camera">üé• Reset Camera</button>
        <button id="export-character">üíæ Export Character</button>
        <button id="import-character">üìÇ Import Character</button>
        <button id="json-pose-editor">üìù JSON Pose Editor</button>
        <input type="file" id="import-file" accept=".json" style="display: none;">
      </div>
      
      <div class="camera-controls">
        <span class="camera-label">Camera Views:</span>
        <button id="view-front" class="view-btn">Front</button>
        <button id="view-back" class="view-btn">Back</button>
        <button id="view-left" class="view-btn">Left</button>
        <button id="view-right" class="view-btn">Right</button>
        <button id="view-top" class="view-btn">Top</button>
        <button id="view-bottom" class="view-btn">Bottom</button>
      </div>
      
      <div class="main-content">
        <div class="canvas-container">
          <div id="three-canvas"></div>
          <div class="controls-overlay">
            <div class="camera-info">
              <small><strong>Camera:</strong> Left: Rotate | Middle: Pan | Right: Zoom</small><br>
              <small><strong>Bone Movement:</strong> Default: Camera-relative | Shift: XZ | Ctrl: XY | Shift+Ctrl: YZ</small>
            </div>
            <div id="plane-indicator" style="display: none;"></div>
          </div>
        </div>
        
        <!-- Compact Selection Box Below Scene -->
        <div class="selection-box-container">
          <div class="compact-selection-box" id="compact-selection-box">
            <div class="selection-header">
              <strong>Selected Joint:</strong>
              <span id="selected-joint-name-compact">None</span>
              <button id="reset-joint-btn-compact" class="reset-btn" style="display: none;">Reset</button>
            </div>
            <div class="selection-details" id="selection-details" style="display: none;">
              <div class="detail-group">
                <span class="detail-label">Position:</span>
                <span class="detail-values">
                  X: <span id="position-x-compact">0.00</span>
                  Y: <span id="position-y-compact">0.00</span>
                  Z: <span id="position-z-compact">0.00</span>
                </span>
              </div>
              <div class="detail-group">
                <span class="detail-label">Rotation:</span>
                <span class="detail-values">
                  X: <span id="rotation-x-compact">0.00¬∞</span>
                  Y: <span id="rotation-y-compact">0.00¬∞</span>
                  Z: <span id="rotation-z-compact">0.00¬∞</span>
                </span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="controls">
          <!-- User Instructions -->
          <div class="instruction-panel">
            <p><strong>üí° Tip:</strong> Click on any red joint control to select it. Details will appear below the scene.</p>
          </div>
          
          <div class="settings-panel">
            <h3 class="collapsible-header" id="settings-header">
              <span>Settings</span>
              <span id="settings-toggle" class="collapse-toggle">‚ñº</span>
            </h3>
            <div id="settings-content" class="collapsible-content">
              <div class="settings-group">
                <h4>Scene</h4>
                <div class="setting-row">
                  <label for="grid-visible">Show Grid</label>
                  <input type="checkbox" id="grid-visible" checked>
                </div>
              </div>
              
              <div class="settings-group">
                <h4>3D Model</h4>
                <div class="setting-row">
                  <label for="gltf-file">Load Model</label>
                  <input type="file" id="gltf-file" accept=".glb,.gltf">
                </div>
                <div class="setting-row">
                  <label for="show-gltf-model">Show Model</label>
                  <input type="checkbox" id="show-gltf-model" checked>
                </div>
                <div class="setting-row">
                  <label for="model-opacity">Model Opacity</label>
                  <input type="range" id="model-opacity" min="0" max="1" step="0.1" value="1">
                  <span class="value-display">1.0</span>
                </div>
                <div class="setting-row">
                  <label for="model-scale">Model Scale</label>
                  <input type="range" id="model-scale" min="0.1" max="5" step="0.1" value="1.0">
                  <span class="value-display">1.0</span>
                </div>
                <div class="setting-row">
                  <label for="bone-depth-limit">Bone Control Depth</label>
                  <input type="range" id="bone-depth-limit" min="0" max="10" step="1" value="3">
                  <span class="value-display">3</span>
                </div>
              </div>
            </div>
          </div>
          
          <div class="undo-redo-panel">
            <h3 class="collapsible-header" id="undo-redo-header">
              <span>Undo/Redo</span>
              <span id="undo-redo-toggle" class="collapse-toggle">‚ñº</span>
            </h3>
            <div id="undo-redo-content" class="collapsible-content">
              <div class="undo-redo-buttons">
                <button id="undo-btn" disabled>‚ü≤ Undo</button>
                <button id="redo-btn" disabled>‚ü≥ Redo</button>
              </div>
              <div class="undo-redo-shortcuts">
                <p><strong>Shortcuts:</strong></p>
                <p>Ctrl+Z: Undo</p>
                <p>Ctrl+Y: Redo</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- JSON Pose Editor Modal -->
    <div id="json-pose-modal" class="modal-overlay" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h3>üìù JSON Pose Editor</h3>
          <button id="close-json-modal" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
          <div class="json-editor-controls">
            <button id="export-current-pose">üì§ Export Current Pose</button>
            <button id="import-from-json">üì• Import Pose</button>
          </div>
          <div class="json-editor-container">
            <textarea id="json-pose-textarea" placeholder="JSON pose data will appear here..." spellcheck="false"></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button id="save-json-pose" class="save-btn">üíæ Save Pose</button>
          <button id="cancel-json-modal" class="cancel-btn">Cancel</button>
        </div>
      </div>
    </div>
    
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
